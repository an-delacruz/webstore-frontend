"use strict";(self.webpackChunkwebstore_frontend=self.webpackChunkwebstore_frontend||[]).push([[130],{130:(P,u,i)=>{i.r(u),i.d(u,{AuthModule:()=>d});var f=i(6895),p=i(9299),r=i(4006),a=i(7550),t=i(4650),_=i(6518),h=i(4859),v=i(4850),c=i(9549),Z=i(7392),x=i(4144),U=i(455);function A(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Username is required"),t.qZA())}function I(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Password is required"),t.qZA())}function L(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div",4)(1,"h1"),t._uU(2,"LOGIN"),t.qZA(),t._UZ(3,"mat-divider",5),t.TgZ(4,"form",6)(5,"mat-form-field",7)(6,"mat-label"),t._uU(7,"Username"),t.qZA(),t._UZ(8,"input",8),t.TgZ(9,"mat-icon",9),t._uU(10,"person"),t.qZA(),t.YNc(11,A,2,0,"mat-error",10),t.qZA(),t.TgZ(12,"mat-form-field",7)(13,"mat-label"),t._uU(14,"Password"),t.qZA(),t._UZ(15,"input",11),t.TgZ(16,"mat-icon",9),t._uU(17,"key"),t.qZA(),t.YNc(18,I,2,0,"mat-error",10),t.qZA(),t.TgZ(19,"button",12),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.login(s.loginForm.value))}),t._uU(20," LOGIN "),t.qZA(),t.TgZ(21,"div",13)(22,"span",14),t._uU(23,"Don't have an account?"),t.qZA(),t.TgZ(24,"span",15),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.mostrarSignUp())}),t._uU(25,"Sign Up"),t.qZA()()()()}if(2&e){const n=t.oxw();t.xp6(4),t.Q6J("formGroup",n.loginForm),t.xp6(1),t.Q6J("color","primary"),t.xp6(6),t.Q6J("ngIf",n.loginForm.controls.username.hasError("required")),t.xp6(1),t.Q6J("color","primary"),t.xp6(6),t.Q6J("ngIf",n.loginForm.controls.password.hasError("required"))}}function C(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Name is required"),t.qZA())}function q(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Lastname is required"),t.qZA())}function T(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Username is required"),t.qZA())}function y(e,o){1&e&&(t.TgZ(0,"div",23)(1,"span"),t._uU(2," Staff"),t.qZA(),t._UZ(3,"mat-slide-toggle",24),t.qZA())}function w(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Username is required"),t.qZA())}function N(e,o){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Username is required"),t.qZA())}function b(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div",16)(1,"h1"),t._uU(2,"SIGN UP"),t.qZA(),t._UZ(3,"mat-divider",5),t.TgZ(4,"form",6)(5,"div",17)(6,"mat-form-field",18)(7,"mat-label"),t._uU(8,"Name"),t.qZA(),t._UZ(9,"input",19),t.YNc(10,C,2,0,"mat-error",10),t.qZA(),t.TgZ(11,"mat-form-field",18)(12,"mat-label"),t._uU(13,"Lastname"),t.qZA(),t._UZ(14,"input",20),t.YNc(15,q,2,0,"mat-error",10),t.qZA()(),t.TgZ(16,"div",17)(17,"mat-form-field",7)(18,"mat-label"),t._uU(19,"Username"),t.qZA(),t._UZ(20,"input",8),t.YNc(21,T,2,0,"mat-error",10),t.qZA(),t.YNc(22,y,4,0,"div",21),t.qZA(),t.TgZ(23,"div",17)(24,"mat-form-field",18)(25,"mat-label"),t._uU(26,"Password"),t.qZA(),t._UZ(27,"input",11),t.YNc(28,w,2,0,"mat-error",10),t.qZA(),t.TgZ(29,"mat-form-field",18)(30,"mat-label"),t._uU(31,"Password"),t.qZA(),t._UZ(32,"input",22),t.YNc(33,N,2,0,"mat-error",10),t.qZA()(),t.TgZ(34,"button",12),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.signup(s.signupForm.value))}),t._uU(35," SIGN UP "),t.qZA(),t.TgZ(36,"div",13)(37,"span",14),t._uU(38,"Already have an account?"),t.qZA(),t.TgZ(39,"span",15),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.mostrarLogIn())}),t._uU(40,"Log In"),t.qZA()()()()}if(2&e){const n=t.oxw();t.xp6(4),t.Q6J("formGroup",n.signupForm),t.xp6(2),t.Q6J("color","primary"),t.xp6(4),t.Q6J("ngIf",n.signupForm.controls.name.hasError("required")),t.xp6(1),t.Q6J("color","primary"),t.xp6(4),t.Q6J("ngIf",n.signupForm.controls.lastname.hasError("required")),t.xp6(2),t.Q6J("color","primary"),t.xp6(4),t.Q6J("ngIf",n.signupForm.controls.username.hasError("required")),t.xp6(1),t.Q6J("ngIf",n.nuevoAdmin),t.xp6(2),t.Q6J("color","primary"),t.xp6(4),t.Q6J("ngIf",n.signupForm.controls.password.hasError("required")),t.xp6(1),t.Q6J("color","primary"),t.xp6(4),t.Q6J("ngIf",n.signupForm.controls.re_password.hasError("required"))}}class l{constructor(o,n,m,s){this.fb=o,this.auth=n,this.activatedRoute=m,this.router=s,this.isLogIn=!0,this.isSignUp=!1,this.loginForm=this.fb.group({username:["",[r.kI.required,r.kI.minLength(4),r.kI.pattern("[a-zA-Z0-9]*")]],password:["",[r.kI.required,r.kI.minLength(8)]]}),this.signupForm=this.fb.group({username:["",[r.kI.required,r.kI.minLength(4),r.kI.pattern("[a-zA-Z0-9]*")]],password:["",[r.kI.required,r.kI.minLength(8)]],re_password:["",[r.kI.required,r.kI.minLength(8)]],is_staff:[!1],name:["",[r.kI.required,r.kI.minLength(2),r.kI.pattern("[a-zA-Z ]*")]],lastname:["",[r.kI.required,r.kI.minLength(2),r.kI.pattern("[a-zA-Z ]*")]]}),this.nuevoAdmin=!1}ngOnInit(){this.activatedRoute.snapshot.data.isSignUp&&this.mostrarSignUp(),this.activatedRoute.snapshot.data.isAdmin&&(this.nuevoAdmin=!0)}login(o){this.loginForm.invalid?a.Notify.failure("Invalid form",{position:"center-bottom"}):(a.Loading.dots("Signing in ",{svgColor:"#5c2b8a"}),this.auth.login(o.username,o.password).subscribe({next:n=>{n.user?(a.Notify.success("Login success",{position:"center-bottom"}),this.router.navigate(["/"]),a.Loading.remove()):(a.Loading.remove(),a.Report.failure("Error","Invalid username or password","OK"))},error:n=>{a.Loading.remove(),console.log("\u{1f680} ~ file: login.component.ts ~ line 63 ~ LoginComponent ~ this.auth.login ~ error",n),a.Report.failure("Error",n.error.message||"Invalid username or password","OK")}}))}signup(o){if(this.signupForm.invalid)return a.Notify.failure("Invalid form",{position:"center-bottom"}),void this.signupForm.markAllAsTouched();o.password===o.re_password?(a.Loading.dots("Loading...",{svgColor:"#5c2b8a"}),this.postSignUp({username:o.username,password:o.password,re_password:o.re_password,is_staff:o.is_staff,first_name:o.name,last_name:o.lastname})):a.Notify.failure("Passwords do not match",{position:"center-bottom"})}postSignUp(o){this.auth.signup(o).subscribe({next:n=>{const{detail:m}=n;a.Loading.remove(),a.Notify.success(m,{position:"center-bottom"})},error:n=>{a.Loading.remove(),a.Report.failure("Error",n.error.message||"Error during signup","OK")},complete:()=>{this.signupForm.reset(),this.mostrarLogIn()}})}mostrarSignUp(){this.isLogIn=!1,this.isSignUp=!0}mostrarLogIn(){this.isLogIn=!0,this.isSignUp=!1}static#t=this.\u0275fac=function(n){return new(n||l)(t.Y36(r.qu),t.Y36(_.e),t.Y36(p.gz),t.Y36(p.F0))};static#n=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-login"]],decls:4,vars:2,consts:[[1,"main"],[1,"container"],["class","login-container",4,"ngIf"],["class","signup-container",4,"ngIf"],[1,"login-container"],[1,"divisor"],[1,"form",3,"formGroup"],["appearance","outline",1,"field",3,"color"],["matInput","","type","text","placeholder","Username","formControlName","username"],["matSuffix",""],[4,"ngIf"],["matInput","","placeholder","Password","formControlName","password","type","password"],["mat-raised-button","","color","primary",3,"click"],[1,"register-container"],[1,"register-span"],[1,"register-link",3,"click"],[1,"signup-container"],[1,"field-group"],["appearance","outline",3,"color"],["matInput","","type","text","placeholder","Name","formControlName","name"],["matInput","","type","text","placeholder","Name","formControlName","lastname"],["class","toggle",4,"ngIf"],["matInput","","placeholder","Repeat Password","formControlName","re_password","type","password"],[1,"toggle"],["formControlName","is_staff","color","primary"]],template:function(n,m){1&n&&(t.TgZ(0,"section",0)(1,"div",1),t.YNc(2,L,26,5,"div",2),t.YNc(3,b,41,12,"div",3),t.qZA()()),2&n&&(t.xp6(2),t.Q6J("ngIf",m.isLogIn),t.xp6(1),t.Q6J("ngIf",m.isSignUp))},dependencies:[f.O5,h.lW,v.d,c.KE,c.hX,c.TO,c.R9,Z.Hw,x.Nt,U.Rr,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u],styles:['@import"https://fonts.googleapis.com/css?family=Montserrat:400,800";.main[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-image:url(login-bg.d7e414fdd8387efa.jpg);background-repeat:no-repeat;background-size:cover}.container[_ngcontent-%COMP%]{margin:auto;background-color:#fff;border-radius:10px;box-shadow:0 14px 28px #00000040,0 10px 10px #00000038}.divisor[_ngcontent-%COMP%]{border-color:#673ab7;border-width:3px;border-radius:25px;width:100%}h1[_ngcontent-%COMP%], .register-span[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif;font-weight:600}.login-container[_ngcontent-%COMP%], .signup-container[_ngcontent-%COMP%]{padding:2rem;display:flex;flex-direction:column;align-items:center}.form[_ngcontent-%COMP%]{margin-top:1rem;width:100%;display:flex;flex-direction:column;gap:1rem}.field[_ngcontent-%COMP%]{flex:1}.register-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;gap:.5rem}.register-link[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif;text-decoration:none;color:#551a8b}.field-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1rem;align-items:flex-start;width:100%;justify-content:space-between}.toggle[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;align-items:center;height:100%;width:-moz-fit-content;width:fit-content}']})}var J=i(1735);const k=[{path:"signup/admin",component:l,canActivate:[J.p],data:{role:"staff",isSignUp:!0,isAdmin:!0}},{path:"",component:l,data:{isAdmin:{isSignUp:!1,nuevoAdmin:!1}}},{path:"signup",component:l,data:{isSignUp:!0,isAdmin:!1}}];class g{static#t=this.\u0275fac=function(n){return new(n||g)};static#n=this.\u0275mod=t.oAB({type:g});static#o=this.\u0275inj=t.cJS({imports:[p.Bz.forChild(k),p.Bz]})}var F=i(4415);class d{static#t=this.\u0275fac=function(n){return new(n||d)};static#n=this.\u0275mod=t.oAB({type:d});static#o=this.\u0275inj=t.cJS({imports:[f.ez,g,F.q,r.UX]})}}}]);